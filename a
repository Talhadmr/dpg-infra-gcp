module "vpc" {
    source = "./modules/vpc"
}

module "vm" {
  source = "./modules/vm"

  vm_name = "dpg-bastion"
  subnetwork = module.vpc.subnetwork_self_link
}

module "vm" {
  source = "./modules/vm"

  vm_name = count.index < var.k8s-vms.master_count ? format("master-%02d", count.index + 1) : format("worker-%02d", count.index - var.k8s-vms.master_count + 1)
  subnetwork = module.vpc.subnetwork_self_link
}
